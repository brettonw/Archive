//-----------------------------------------------------------------------------
// Copyright (C) 1997-2006 Bretton Wade
// All Rights Reserved
//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
// include files
//-----------------------------------------------------------------------------
#include    "precompile.h"
#include    "task.h"

//-----------------------------------------------------------------------------
// force this module to be loaded
//-----------------------------------------------------------------------------
DEFINE_FORCED_LOAD (COM);

//-----------------------------------------------------------------------------
// tasks
//-----------------------------------------------------------------------------
DEFINE_TASK (COM)
{
    DO_AFTER (Main);
}

//-----------------------------------------------------------------------------
HANDLE_MESSAGE (COM, msg)
{
    switch (msg)
    {
        case Task::STARTUP:
            return (CoInitialize (0) == S_OK);

        case Task::SHUTDOWN:
            CoUninitialize ();
            return true;
            
        default:
            return false;
    }
}

//-----------------------------------------------------------------------------
